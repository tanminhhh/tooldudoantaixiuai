<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Tool D·ª± ƒëo√°n T√†i X·ªâu T√≠ch AI ƒëa thu·∫≠t to√°n n√¢ng cao by TANMINHDEV_</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto:wght@400;500&display=swap');
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    background: linear-gradient(135deg, #0a122a, #020615);
    font-family: 'Orbitron', 'Roboto', sans-serif;
    color: #00ffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 1.5em 1em 3em 1em;
    user-select: none;
    overflow-x: hidden;
    background-image: url('https://images.unsplash.com/photo-1518773553398-650c184e0bb3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80');
    background-size: cover;
    background-position: center;
    position: relative;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 17, 29, 0.92);
    z-index: -1;
  }
  h1 {
    font-weight: 900;
    font-size: 2.4em;
    color: #00eaff;
    text-align: center;
    margin-bottom: 0.3em;
    text-shadow: 0 0 12px #00faff70, 0 0 24px #00d0ff90, 0 0 36px #08d9d930;
    letter-spacing: 3px;
  }
  h2 {
    font-weight: 600;
    font-size: 1.1em;
    text-align: center;
    margin-bottom: 1.6em;
    color: #33e5e5cc;
    user-select: none;
    text-shadow: 0 0 10px #33eeeebb;
  }
  .container {
    background: rgba(0, 255, 255, 0.12);
    border-radius: 28px;
    border: 2px solid #0ff4f4cc;
    box-shadow: 0 0 60px #0ff4f4bb, inset 0 0 120px #37ffff5533;
    padding: 32px 36px 44px 36px;
    width: 460px;
    max-width: 96vw;
    display: flex;
    flex-direction: column;
    user-select: none;
    position: relative;
    backdrop-filter: blur(20px);
  }
  .instructions {
    font-weight: 600;
    color: #33ffffcc;
    margin-bottom: 1.5em;
    letter-spacing: 1.4px;
    font-size: 1em;
    user-select: none;
    line-height: 1.6;
  }
  .input-buttons {
    display: flex;
    gap: 32px;
    justify-content: center;
    margin-bottom: 1.8em;
  }
  button.btn-input {
    position: relative;
    background: linear-gradient(145deg, #062730, #004055);
    border: 2.8px solid #06fcf8cc;
    border-radius: 26px;
    padding: 20px 0;
    flex: 1 1 160px;
    color: #06fcf8;
    font-weight: 700;
    font-size: 1.85em;
    cursor: pointer;
    user-select: none;
    text-align: center;
    box-shadow: 0 0 10px #06fcf8cc, inset 0 0 35px #06fcf877;
    transition: all 0.3s ease;
    overflow: hidden;
    filter: drop-shadow(0 0 8px #06ccf8aa);
  }
  button.btn-input:hover {
    background: linear-gradient(145deg, #0affff, #1b9dff);
    box-shadow: 0 0 26px #0affffdd, 0 0 50px #0affffbb, inset 0 0 80px #0affffcc;
    filter: drop-shadow(0 0 18px #0affffcc);
    transform: translateY(-2px);
  }
  button.btn-input:active {
    background: linear-gradient(145deg, #0bcae6, #147fda);
    filter: drop-shadow(0 0 12px #0affffaa);
    transform: translateY(1px);
  }
  button.btn-input::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 16px;
    transform: translateY(-50%);
    width: 30px;
    height: 30px;
    background-repeat: no-repeat;
    background-size: contain;
    filter: drop-shadow(0 0 2px #00f7f7bb);
    transition: all 0.3s ease;
  }
  #btnTai::before {
    background-image: url('https://cdn-icons-png.flaticon.com/512/2737/2737510.png');
  }
  #btnXiu::before {
    background-image: url('https://cdn-icons-png.flaticon.com/512/2737/2737505.png');
  }
  .display-results {
    background: rgba(0, 55, 90, 0.95);
    border-radius: 22px;
    padding: 16px 22px;
    margin-top: 1.2em;
    min-height: 52px;
    font-size: 1.2em;
    line-height: 1.5em;
    font-weight: 700;
    color: #77ffffcc;
    box-shadow: inset 0 0 30px #11ffffcc;
    user-select: text;
    white-space: nowrap;
    overflow-x: auto;
    border: 1px solid #00aaffaa;
    filter: drop-shadow(0 0 6px #0077ffaa);
    letter-spacing: 0.06em;
    transition: all 0.3s ease;
  }
  .display-results:hover {
    box-shadow: inset 0 0 40px #11ffffdd;
  }
  .controls-row {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 2.4em;
  }
  button.btn-action {
    background-image: linear-gradient(45deg, #00f7ff, #008aff);
    border: none;
    border-radius: 30px;
    padding: 18px 0;
    font-family: 'Orbitron', sans-serif;
    font-weight: 900;
    font-size: 1.4em;
    color: #001622;
    text-transform: uppercase;
    letter-spacing: 3.5px;
    cursor: pointer;
    box-shadow: 0 0 50px #22ffffee, 0 10px 30px #0099ffcc;
    transition: all 0.3s ease;
    user-select: none;
    flex: 1 1 180px;
    position: relative;
    overflow: hidden;
    filter: drop-shadow(0 0 12px #00ccffdd);
  }
  button.btn-action:hover {
    box-shadow: 0 0 80px #33ffffdd, 0 0 130px #00bbffdd, 0 0 160px #0099ffff;
    transform: scale(1.05);
    letter-spacing: 4px;
  }
  button.btn-action:active {
    transform: scale(0.96);
  }
  button.btn-action::after {
    content: "";
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      to bottom right,
      rgba(255, 255, 255, 0) 0%,
      rgba(255, 255, 255, 0) 45%,
      rgba(255, 255, 255, 0.3) 48%,
      rgba(255, 255, 255, 0.3) 52%,
      rgba(255, 255, 255, 0) 55%,
      rgba(255, 255, 255, 0) 100%
    );
    transform: rotate(30deg);
    animation: shine 3s infinite;
  }
  @keyframes shine {
    0% { transform: translateX(-100%) rotate(30deg); }
    100% { transform: translateX(100%) rotate(30deg); }
  }
  .results {
    margin-top: 3em;
    background: rgba(0, 40, 70, 0.96);
    color: #44ffeecc;
    font-weight: 700;
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    white-space: pre-wrap;
    letter-spacing: 0.06em;
    border-radius: 26px;
    padding: 28px 30px;
    min-height: 10em;
    box-shadow: inset 0 0 40px #22ccffff;
    user-select: text;
    outline: none;
    position: relative;
    overflow-wrap: break-word;
    transition: all 0.3s ease;
  }
  .results:hover {
    box-shadow: inset 0 0 60px #22ccffff;
  }
  .footer {
    margin-top: 4em;
    font-size: 0.75em;
    letter-spacing: 1.8px;
    color: #004369cc;
    user-select: none;
  }
  .display-results::-webkit-scrollbar {
    height: 9px;
  }
  .display-results::-webkit-scrollbar-track {
    background: #00213588;
  }
  .display-results::-webkit-scrollbar-thumb {
    background: #0fffbbaa;
    border-radius: 8px;
  }
  #analyzingEffect {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(12px);
  }
  #analyzingEffect .loader {
    width: 120px;
    height: 120px;
    position: relative;
    margin-bottom: 20px;
  }
  #analyzingEffect .loader:before,
  #analyzingEffect .loader:after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
  }
  #analyzingEffect .loader:before {
    z-index: 100;
    border: 3px solid transparent;
    border-top-color: #00ffff;
    border-right-color: #00ffff;
    animation: spin 1s linear infinite;
  }
  #analyzingEffect .loader:after {
    border: 3px solid rgba(0, 255, 255, 0.1);
  }
  #analyzingEffect .ai-text {
    color: #00ffff;
    font-size: 1.2em;
    text-align: center;
    animation: pulse 2s infinite;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    margin-top: 20px;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  @keyframes pulse {
    0% { opacity: 0.6; transform: scale(0.98); }
    50% { opacity: 1; transform: scale(1.02); }
    100% { opacity: 0.6; transform: scale(0.98); }
  }
  .prediction-result {
    font-size: 1.5em;
    text-align: center;
    margin: 15px 0;
    padding: 15px;
    border-radius: 15px;
    background: rgba(0, 80, 120, 0.5);
    transition: all 0.3s ease;
  }
  .prediction-result:hover {
    transform: scale(1.02);
  }
  .tai-prediction {
    color: #00ffff;
    border: 2px solid #00ffff;
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
  }
  .xiu-prediction {
    color: #ff77aa;
    border: 2px solid #ff77aa;
    box-shadow: 0 0 20px rgba(255, 119, 170, 0.3);
  }
  .analysis-item {
    margin: 8px 0;
    padding: 8px 12px;
    border-left: 3px solid #00ffff;
    background: rgba(0, 150, 200, 0.1);
    border-radius: 0 8px 8px 0;
    transition: all 0.3s ease;
  }
  .analysis-item:hover {
    background: rgba(0, 150, 200, 0.2);
    transform: translateX(5px);
  }
  /* Modal bi·ªÉu ƒë·ªì n√¢ng cao */
  .chart-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 1001;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  .chart-container {
    background: rgba(0, 45, 80, 0.98);
    border-radius: 20px;
    padding: 25px;
    width: 90%;
    max-width: 600px;
    position: relative;
    box-shadow: 0 0 50px rgba(0, 200, 255, 0.2);
    border: 1px solid rgba(0, 255, 255, 0.3);
    animation: slideUp 0.4s ease;
  }
  @keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  .chart-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #ff3366;
    color: white;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all 0.3s ease;
  }
  .chart-close:hover {
    transform: rotate(90deg);
    background: #ff0044;
  }
  canvas {
    max-width: 100%;
    height: 300px;
    margin: 15px 0;
  }
  .chart-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
    flex-wrap: wrap;
  }
  .chart-btn {
    background: rgba(0, 150, 200, 0.3);
    color: #00ffff;
    border: none;
    border-radius: 15px;
    padding: 8px 15px;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Orbitron', sans-serif;
    letter-spacing: 1px;
  }
  .chart-btn.active {
    background: rgba(0, 255, 255, 0.5);
    color: #003333;
    font-weight: bold;
  }
  .chart-btn:hover {
    background: rgba(0, 255, 255, 0.4);
    transform: translateY(-2px);
  }
  /* N√∫t bi·ªÉu ƒë·ªì trong k·∫øt qu·∫£ */
  .btn-chart {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(0, 150, 200, 0.3);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all 0.3s ease;
    z-index: 10;
  }
  .btn-chart:hover {
    background: rgba(0, 255, 255, 0.5);
    transform: scale(1.1) rotate(15deg);
  }
  .btn-chart img {
    width: 25px;
    height: 25px;
    filter: drop-shadow(0 0 5px #00ffff);
    transition: all 0.3s ease;
  }
  .btn-chart:hover img {
    transform: scale(1.1);
  }
  /* Th√™m hi·ªáu ·ª©ng cho k·∫øt qu·∫£ nh·∫≠p v√†o */
  .result-entry {
    display: inline-block;
    animation: popIn 0.3s ease;
    margin: 0 2px;
  }
  @keyframes popIn {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }
  /* Th√™m tab ph√¢n t√≠ch */
  .analysis-tabs {
    display: flex;
    margin-bottom: 15px;
    border-bottom: 1px solid rgba(0, 255, 255, 0.3);
  }
  .tab-btn {
    padding: 8px 15px;
    background: transparent;
    border: none;
    color: #00ffff;
    cursor: pointer;
    font-family: 'Orbitron', sans-serif;
    font-size: 0.9em;
    position: relative;
    transition: all 0.3s ease;
  }
  .tab-btn.active {
    color: #00ffff;
    font-weight: bold;
  }
  .tab-btn.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 100%;
    height: 2px;
    background: #00ffff;
    animation: tabUnderline 0.3s ease;
  }
  @keyframes tabUnderline {
    from { width: 0; left: 50%; }
    to { width: 100%; left: 0; }
  }
  .tab-btn:hover {
    color: #00aaff;
  }
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
    animation: fadeIn 0.5s ease;
  }
  /* Th√™m ph·∫ßn l·ªãch s·ª≠ */
  .history-item {
    padding: 8px;
    margin: 5px 0;
    background: rgba(0, 80, 120, 0.2);
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .history-item:hover {
    background: rgba(0, 80, 120, 0.4);
    transform: translateX(5px);
  }
  /* Th√™m ph·∫ßn c√†i ƒë·∫∑t */
  .settings-option {
    margin: 10px 0;
  }
  .settings-option label {
    display: flex;
    align-items: center;
    cursor: pointer;
  }
  .settings-option input[type="checkbox"] {
    margin-right: 10px;
    width: 18px;
    height: 18px;
  }
  /* Responsive */
  @media screen and (max-width:480px) {
    .container {
      width: 94vw;
      padding: 26px 18px 50px 18px;
    }
    h1 {
      font-size: 1.9em;
      letter-spacing: 2px;
    }
    h2 {
      font-size: 1.05em;
    }
    button.btn-input {
      font-size: 1.6em;
      padding: 16px 0;
      flex: 1 1 130px;
    }
    button.btn-action {
      font-size: 1.2em;
      padding: 16px 0;
      letter-spacing: 3px;
      flex: 1 1 150px;
    }
    .display-results {
      font-size: 1.1em;
      min-height: 50px;
    }
    .prediction-result {
      font-size: 1.3em;
    }
    .btn-chart {
      width: 35px;
      height: 35px;
      top: 10px;
      right: 10px;
    }
    .btn-chart img {
      width: 20px;
      height: 20px;
    }
    .input-buttons {
      gap: 15px;
    }
    .controls-row {
      gap: 15px;
    }
  }
</style>
</head>
<body>
  <div id="analyzingEffect" style="display: none;">
    <div class="loader"></div>
    <div class="ai-text">AI PRO ƒëang ph√¢n t√≠ch d·ªØ li·ªáu...</div>
    <div class="ai-text" id="aiProcessText">√Åp d·ª•ng thu·∫≠t to√°n Markov Chain...</div>
  </div>

  <!-- Modal bi·ªÉu ƒë·ªì n√¢ng cao -->
  <div id="chartModal" class="chart-modal">
    <div class="chart-container">
      <button class="chart-close">&times;</button>
      <canvas id="freqChart"></canvas>
      <canvas id="confChart" style="display: none;"></canvas>
      <canvas id="probChart" style="display: none;"></canvas>
      <div class="chart-buttons">
        <button id="btnFreqChart" class="chart-btn active">T·∫ßn su·∫•t</button>
        <button id="btnConfChart" class="chart-btn">ƒê·ªô tin c·∫≠y</button>
        <button id="btnProbChart" class="chart-btn">X√°c su·∫•t</button>
      </div>
    </div>
  </div>

  <main class="container">
    <h1>Tool D·ª± ƒêo√°n T√†i X·ªâu By TANMINH DEV_</h1>
    <h2>AI ƒëa thu·∫≠t to√°n n√¢ng cao v·ªõi Markov Chain & LSTM</h2>

    <div class="instructions">
      üü¶ Nh·∫•n "T√†i" ho·∫∑c "X·ªâu" ƒë·ªÉ nh·∫≠p k·∫øt qu·∫£<br />
      ü§ñ AI PRO s·∫Ω ph√¢n t√≠ch b·∫±ng 3 thu·∫≠t to√°n<br />
      üìä Xem bi·ªÉu ƒë·ªì ph√¢n t√≠ch chi ti·∫øt sau khi d·ª± ƒëo√°n
    </div>

    <div class="input-buttons">
      <button type="button" class="btn-input" id="btnTai">T√†i</button>
      <button type="button" class="btn-input" id="btnXiu">X·ªâu</button>
    </div>

    <div class="display-results" id="displayResults">
      Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c nh·∫≠p.
    </div>

    <div class="controls-row">
      <button type="button" class="btn-action" id="btnAnalyze">Ph√¢n t√≠ch AI PRO</button>
      <button type="button" class="btn-action" id="btnClear">X√≥a k·∫øt qu·∫£</button>
    </div>

    <section class="results" id="results">
      <div class="analysis-tabs">
        <button class="tab-btn active" data-tab="prediction">D·ª± ƒëo√°n</button>
        <button class="tab-btn" data-tab="history">L·ªãch s·ª≠</button>
        <button class="tab-btn" data-tab="settings">C√†i ƒë·∫∑t</button>
      </div>
      
      <div class="tab-content active" id="prediction-tab">
        Vui l√≤ng b·∫Øt ƒë·∫ßu nh·∫≠p k·∫øt qu·∫£ b·∫±ng c√°ch nh·∫•n n√∫t T√†i ho·∫∑c X·ªâu.
      </div>
      
      <div class="tab-content" id="history-tab">
        <div id="historyList"></div>
      </div>
      
      <div class="tab-content" id="settings-tab">
        <div class="settings-option">
          <label>
            <input type="checkbox" id="enableSound" checked> B·∫≠t √¢m thanh th√¥ng b√°o
          </label>
        </div>
        <div class="settings-option">
          <label>
            <input type="checkbox" id="enableAnimations" checked> B·∫≠t hi·ªáu ·ª©ng h√¨nh ·∫£nh
          </label>
        </div>
        <div class="settings-option">
          <label>
            <input type="checkbox" id="saveHistory" checked> L∆∞u l·ªãch s·ª≠ ph√¢n t√≠ch
          </label>
        </div>
      </div>
      
      <!-- N√∫t bi·ªÉu ƒë·ªì s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·∫±ng JavaScript -->
    </section>
  </main>

  <div class="footer">
    ¬© 2025 Tool D·ª± ƒêo√°n T√†i X·ªâu PRO - Phi√™n b·∫£n AI n√¢ng cao 2.0
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  // C√°c bi·∫øn to√†n c·ª•c
  const btnTai = document.getElementById('btnTai');
  const btnXiu = document.getElementById('btnXiu');
  const displayResults = document.getElementById('displayResults');
  const btnAnalyze = document.getElementById('btnAnalyze');
  const btnClear = document.getElementById('btnClear');
  const resultsBox = document.getElementById('results');
  const predictionTab = document.getElementById('prediction-tab');
  const historyTab = document.getElementById('history-tab');
  const settingsTab = document.getElementById('settings-tab');
  const historyList = document.getElementById('historyList');
  const chartModal = document.getElementById('chartModal');
  const freqCanvas = document.getElementById('freqChart');
  const confCanvas = document.getElementById('confChart');
  const probCanvas = document.getElementById('probChart');
  const btnFreqChart = document.getElementById('btnFreqChart');
  const btnConfChart = document.getElementById('btnConfChart');
  const btnProbChart = document.getElementById('btnProbChart');
  const chartClose = document.querySelector('.chart-close');
  const tabBtns = document.querySelectorAll('.tab-btn');
  const enableSound = document.getElementById('enableSound');
  const enableAnimations = document.getElementById('enableAnimations');
  const saveHistory = document.getElementById('saveHistory');
  const aiProcessText = document.getElementById('aiProcessText');

  let enteredResults = [];
  let freqChart = null;
  let confChart = null;
  let probChart = null;
  let analysisHistory = [];
  
  // Kh·ªüi t·∫°o √¢m thanh
  const clickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3');
  const successSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3');
  const errorSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-warning-alarm-688.mp3');
  
  // T·∫£i d·ªØ li·ªáu t·ª´ localStorage n·∫øu c√≥
  function loadData() {
    const savedResults = localStorage.getItem('taiXiuResults');
    const savedHistory = localStorage.getItem('taiXiuHistory');
    const savedSettings = localStorage.getItem('taiXiuSettings');
    
    if (savedResults) {
      enteredResults = JSON.parse(savedResults);
      updateDisplay();
    }
    
    if (savedHistory) {
      analysisHistory = JSON.parse(savedHistory);
      renderHistory();
    }
    
    if (savedSettings) {
      const settings = JSON.parse(savedSettings);
      enableSound.checked = settings.enableSound;
      enableAnimations.checked = settings.enableAnimations;
      saveHistory.checked = settings.saveHistory;
    }
  }
  
  // L∆∞u d·ªØ li·ªáu v√†o localStorage
  function saveData() {
    if (saveHistory.checked) {
      localStorage.setItem('taiXiuResults', JSON.stringify(enteredResults));
      localStorage.setItem('taiXiuHistory', JSON.stringify(analysisHistory));
    }
    
    localStorage.setItem('taiXiuSettings', JSON.stringify({
      enableSound: enableSound.checked,
      enableAnimations: enableAnimations.checked,
      saveHistory: saveHistory.checked
    }));
  }
  
  // Hi·ªÉn th·ªã l·ªãch s·ª≠ ph√¢n t√≠ch
  function renderHistory() {
    historyList.innerHTML = '';
    
    if (analysisHistory.length === 0) {
      historyList.innerHTML = '<div style="color:#00aaff; text-align:center;">Ch∆∞a c√≥ l·ªãch s·ª≠ ph√¢n t√≠ch</div>';
      return;
    }
    
    analysisHistory.reverse().forEach((item, index) => {
      const historyItem = document.createElement('div');
      historyItem.className = 'history-item';
      historyItem.innerHTML = `
        <div><strong>Ph√¢n t√≠ch #${analysisHistory.length - index}</strong></div>
        <div>${item.date}</div>
        <div>K·∫øt qu·∫£: ${item.results.join(' ')}</div>
        <div>D·ª± ƒëo√°n: ${item.prediction}</div>
      `;
      
      historyItem.addEventListener('click', () => {
        enteredResults = [...item.results];
        updateDisplay();
        predictionTab.innerHTML = item.message;
        document.querySelector('.tab-btn[data-tab="prediction"]').click();
        
        // Hi·ªÉn th·ªã n√∫t bi·ªÉu ƒë·ªì
        btnChart.style.display = 'flex';
        renderCharts(enteredResults);
        
        if (enableSound.checked) {
          clickSound.play();
        }
      });
      
      historyList.appendChild(historyItem);
    });
  }
  
  // T·∫°o n√∫t bi·ªÉu ƒë·ªì v√† th√™m v√†o DOM
  const btnChart = document.createElement('button');
  btnChart.className = 'btn-chart';
  btnChart.style.display = 'none';
  btnChart.innerHTML = '<img src="https://cdn-icons-png.flaticon.com/512/2103/2103633.png" alt="Bi·ªÉu ƒë·ªì">';
  resultsBox.appendChild(btnChart);

  // C·∫≠p nh·∫≠t hi·ªÉn th·ªã k·∫øt qu·∫£ nh·∫≠p
  function updateDisplay() {
    displayResults.innerHTML = '';
    
    if (enteredResults.length === 0) {
      displayResults.textContent = 'Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c nh·∫≠p.';
      return;
    }
    
    enteredResults.forEach(result => {
      const span = document.createElement('span');
      span.className = 'result-entry';
      span.textContent = result;
      span.style.color = result === 'T√†i' ? '#00ffff' : '#ff77aa';
      displayResults.appendChild(span);
    });
    
    // Cu·ªôn ƒë·∫øn cu·ªëi
    displayResults.scrollLeft = displayResults.scrollWidth;
  }

  // Ph√°t hi·ªán chu·ªói li√™n ti·∫øp
  function detectStreaks(results) {
    let streaks = {
      currentTai: 0,
      currentXiu: 0,
      maxTai: 0,
      maxXiu: 0,
      taiSequences: [],
      xiuSequences: []
    };
    
    let currentSequence = [];
    let currentType = null;
    
    for (const result of results) {
      if (result === 'T√†i') {
        streaks.currentTai++;
        streaks.currentXiu = 0;
        
        if (currentType !== 'T√†i') {
          if (currentSequence.length > 0) {
            if (currentType === 'X·ªâu') {
              streaks.xiuSequences.push([...currentSequence]);
            }
          }
          currentSequence = [result];
          currentType = 'T√†i';
        } else {
          currentSequence.push(result);
        }
        
        streaks.maxTai = Math.max(streaks.maxTai, streaks.currentTai);
      } else {
        streaks.currentXiu++;
        streaks.currentTai = 0;
        
        if (currentType !== 'X·ªâu') {
          if (currentSequence.length > 0) {
            if (currentType === 'T√†i') {
              streaks.taiSequences.push([...currentSequence]);
            }
          }
          currentSequence = [result];
          currentType = 'X·ªâu';
        } else {
          currentSequence.push(result);
        }
        
        streaks.maxXiu = Math.max(streaks.maxXiu, streaks.currentXiu);
      }
    }
    
    // Th√™m chu·ªói cu·ªëi c√πng
    if (currentSequence.length > 0) {
      if (currentType === 'T√†i') {
        streaks.taiSequences.push([...currentSequence]);
      } else {
        streaks.xiuSequences.push([...currentSequence]);
      }
    }
    
    return streaks;
  }

  // Ph√¢n t√≠ch xu h∆∞·ªõng
  function analyzeTrends(results) {
    if (results.length < 3) return null;
    
    // Xu h∆∞·ªõng ng·∫Øn h·∫°n (3 k·∫øt qu·∫£ cu·ªëi)
    const lastThree = results.slice(-3);
    const shortTrend = lastThree.reduce((acc, cur) => cur === 'T√†i' ? acc + 1 : acc - 1, 0);
    
    // Xu h∆∞·ªõng trung h·∫°n (5 k·∫øt qu·∫£ cu·ªëi n·∫øu c√≥)
    let midTrend = null;
    if (results.length >= 5) {
      const lastFive = results.slice(-5);
      midTrend = lastFive.reduce((acc, cur) => cur === 'T√†i' ? acc + 1 : acc - 1, 0);
    }
    
    // Xu h∆∞·ªõng d√†i h·∫°n (to√†n b·ªô)
    const longTrend = results.reduce((acc, cur) => cur === 'T√†i' ? acc + 1 : acc - 1, 0);
    
    return {
      short: shortTrend > 0 ? 'T√†i' : 'X·ªâu',
      mid: midTrend !== null ? (midTrend > 0 ? 'T√†i' : 'X·ªâu') : null,
      long: longTrend > 0 ? 'T√†i' : 'X·ªâu'
    };
  }

  // Thu·∫≠t to√°n Markov Chain
  function markovChainPrediction(results) {
    if (results.length < 2) return null;
    
    // Kh·ªüi t·∫°o ma tr·∫≠n chuy·ªÉn ƒë·ªïi
    const transitionMatrix = {
      'T√†i': { 'T√†i': 0, 'X·ªâu': 0 },
      'X·ªâu': { 'T√†i': 0, 'X·ªâu': 0 }
    };
    
    // T√≠nh to√°n ma tr·∫≠n chuy·ªÉn ƒë·ªïi t·ª´ d·ªØ li·ªáu l·ªãch s·ª≠
    for (let i = 0; i < results.length - 1; i++) {
      const current = results[i];
      const next = results[i + 1];
      transitionMatrix[current][next]++;
    }
    
    // T√≠nh x√°c su·∫•t chuy·ªÉn ƒë·ªïi
    const lastResult = results[results.length - 1];
    const taiCount = transitionMatrix[lastResult]['T√†i'];
    const xiuCount = transitionMatrix[lastResult]['X·ªâu'];
    const total = taiCount + xiuCount;
    
    if (total === 0) return null;
    
    const taiProb = taiCount / total;
    const xiuProb = xiuCount / total;
    
    return {
      prediction: taiProb > xiuProb ? 'T√†i' : 'X·ªâu',
      confidence: Math.max(taiProb, xiuProb),
      taiProb,
      xiuProb
    };
  }

  // Thu·∫≠t to√°n LSTM ƒë∆°n gi·∫£n (m√¥ ph·ªèng)
  function lstmPrediction(results) {
    if (results.length < 5) return null;
    
    // ƒê√¢y ch·ªâ l√† m√¥ ph·ªèng ƒë∆°n gi·∫£n, LSTM th·ª±c s·ª± c·∫ßn model ƒë∆∞·ª£c train tr∆∞·ªõc
    // Ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng trung b√¨nh ƒë·ªông c√≥ tr·ªçng s·ªë
    const weights = [0.1, 0.15, 0.25, 0.3, 0.2]; // Tr·ªçng s·ªë cho 5 k·∫øt qu·∫£ g·∫ßn nh·∫•t
    const lastFive = results.slice(-5);
    
    let score = 0;
    for (let i = 0; i < 5; i++) {
      score += (lastFive[i] === 'T√†i' ? 1 : -1) * weights[i];
    }
    
    const sigmoid = (x) => 1 / (1 + Math.exp(-x));
    const confidence = sigmoid(Math.abs(score));
    
    return {
      prediction: score > 0 ? 'T√†i' : 'X·ªâu',
      confidence,
      taiProb: score > 0 ? confidence : 1 - confidence,
      xiuProb: score > 0 ? 1 - confidence : confidence
    };
  }

  // D·ª± ƒëo√°n t·ªïng h·ª£p t·ª´ nhi·ªÅu thu·∫≠t to√°n
  function combinedPrediction(results) {
    if (results.length < 2) {
      return {
        prediction: null,
        message: '<div style="color:#ff5555;">‚ùó B·∫°n c·∫ßn nh·∫≠p √≠t nh·∫•t 2 k·∫øt qu·∫£ ƒë·ªÉ ph√¢n t√≠ch.</div>'
      };
    }

    // T√≠nh to√°n t·ª∑ l·ªá c∆° b·∫£n
    const taiCount = results.filter(r => r === 'T√†i').length;
    const total = results.length;
    const taiRatio = taiCount / total;

    // Ph√¢n t√≠ch n√¢ng cao
    const streaks = detectStreaks(results);
    const trends = analyzeTrends(results);
    const markov = markovChainPrediction(results);
    const lstm = lstmPrediction(results);

    // T√≠nh ƒëi·ªÉm d·ª± ƒëo√°n t·ª´ c√°c thu·∫≠t to√°n
    let taiScore = taiRatio * 0.4; // T·ª∑ l·ªá l·ªãch s·ª≠
    let xiuScore = (1 - taiRatio) * 0.4;

    // ƒêi·ªÉm t·ª´ Markov Chain
    if (markov) {
      taiScore += markov.taiProb * 0.3;
      xiuScore += markov.xiuProb * 0.3;
    }

    // ƒêi·ªÉm t·ª´ LSTM (n·∫øu c√≥)
    if (lstm) {
      taiScore += lstm.taiProb * 0.3;
      xiuScore += lstm.xiuProb * 0.3;
    }

    // ƒêi·ªÅu ch·ªânh ƒëi·ªÉm d·ª±a tr√™n streaks
    if (streaks.currentTai >= 2) taiScore += 0.2;
    if (streaks.currentXiu >= 2) xiuScore += 0.2;

    // ƒêi·ªÅu ch·ªânh ƒëi·ªÉm d·ª±a tr√™n xu h∆∞·ªõng
    if (trends) {
      if (trends.short === 'T√†i') taiScore += 0.1;
      else xiuScore += 0.1;
      
      if (trends.mid && trends.mid === 'T√†i') taiScore += 0.05;
      else if (trends.mid) xiuScore += 0.05;
    }

    // X√°c ƒë·ªãnh k·∫øt qu·∫£ cu·ªëi c√πng
    const prediction = taiScore > xiuScore ? 'T√†i' : 'X·ªâu';
    const confidence = Math.max(taiScore, xiuScore) / (taiScore + xiuScore);

    // T·∫°o th√¥ng b√°o chi ti·∫øt
    let message = `<div class="prediction-result ${prediction === 'T√†i' ? 'tai-prediction' : 'xiu-prediction'}">`;
    message += `D·ª∞ ƒêO√ÅN K·∫æT QU·∫¢ TI·∫æP THEO: ${prediction.toUpperCase()}`;
    message += `</div>`;
    
    message += `<div class="analysis-item">üìä T·ª∑ l·ªá l·ªãch s·ª≠: T√†i ${(taiRatio*100).toFixed(1)}% | X·ªâu ${((1-taiRatio)*100).toFixed(1)}%</div>`;
    
    if (streaks.currentTai >= 2 || streaks.currentXiu >= 2) {
      message += `<div class="analysis-item">üìà Chu·ªói hi·ªán t·∫°i: T√†i ${streaks.currentTai} l·∫ßn | X·ªâu ${streaks.currentXiu} l·∫ßn</div>`;
    }
    
    if (streaks.maxTai >= 3 || streaks.maxXiu >= 3) {
      message += `<div class="analysis-item">üìâ Chu·ªói d√†i nh·∫•t: T√†i ${streaks.maxTai} | X·ªâu ${streaks.maxXiu}</div>`;
    }
    
    if (trends) {
      message += `<div class="analysis-item">üîç Xu h∆∞·ªõng ng·∫Øn h·∫°n: ${trends.short}`;
      if (trends.mid) message += ` | Trung h·∫°n: ${trends.mid}`;
      message += ` | D√†i h·∫°n: ${trends.long}</div>`;
    }
    
    if (markov) {
      message += `<div class="analysis-item">üßÆ Markov Chain: ${markov.prediction} (${(markov.confidence*100).toFixed(1)}%)</div>`;
    }
    
    if (lstm) {
      message += `<div class="analysis-item">ü§ñ LSTM Network: ${lstm.prediction} (${(lstm.confidence*100).toFixed(1)}%)</div>`;
    }
    
    message += `<div class="analysis-item">üí° M·∫πo chuy√™n gia: ${getExpertTip(streaks, trends, taiRatio)}</div>`;

    return { 
      prediction, 
      message,
      confidence: Math.round(confidence * 100),
      taiRatio: Math.round(taiRatio * 100),
      streaks,
      trends,
      markov,
      lstm
    };
  }

  // M·∫πo chuy√™n gia d·ª±a tr√™n ph√¢n t√≠ch
  function getExpertTip(streaks, trends, taiRatio) {
    const tips = [];
    
    // M·∫πo d·ª±a tr√™n chu·ªói
    if (streaks.currentTai >= 3) {
      tips.push("Chu·ªói T√†i d√†i, c√¢n nh·∫Øc ƒë·∫∑t X·ªâu cho l∆∞·ª£t ti·∫øp theo");
    } else if (streaks.currentXiu >= 3) {
      tips.push("Chu·ªói X·ªâu d√†i, c√¢n nh·∫Øc ƒë·∫∑t T√†i cho l∆∞·ª£t ti·∫øp theo");
    }
    
    // M·∫πo d·ª±a tr√™n xu h∆∞·ªõng
    if (trends) {
      if (trends.short !== trends.long) {
        tips.push("Xu h∆∞·ªõng ng·∫Øn h·∫°n v√† d√†i h·∫°n tr√°i ng∆∞·ª£c, c·∫ßn th·∫≠n tr·ªçng");
      }
      
      if (trends.mid && trends.short === trends.mid && trends.mid === trends.long) {
        tips.push("Xu h∆∞·ªõng ƒë·ªìng nh·∫•t ·ªü c·∫£ 3 khung, c√≥ th·ªÉ ti·∫øp t·ª•c");
      }
    }
    
    // M·∫πo d·ª±a tr√™n t·ª∑ l·ªá
    if (taiRatio > 0.7) {
      tips.push("T·ª∑ l·ªá T√†i cao, c√¢n nh·∫Øc ƒë·∫∑t X·ªâu ƒë·ªÉ c√¢n b·∫±ng");
    } else if (taiRatio < 0.3) {
      tips.push("T·ª∑ l·ªá X·ªâu cao, c√¢n nh·∫Øc ƒë·∫∑t T√†i ƒë·ªÉ c√¢n b·∫±ng");
    }
    
    // M·∫πo m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥ ƒëi·ªÅu ki·ªán ƒë·∫∑c bi·ªát
    if (tips.length === 0) {
      const defaultTips = [
        "K·∫øt h·ª£p nhi·ªÅu y·∫øu t·ªë ƒë·ªÉ c√≥ quy·∫øt ƒë·ªãnh t·ªët nh·∫•t",
        "Chu·ªói d√†i h∆°n 5 l·∫ßn th∆∞·ªùng hi·∫øm khi x·∫£y ra",
        "Khi c·∫ßu b·ªã b·∫ª li√™n t·ª•c, h√£y ch·ªù 3-4 l∆∞·ª£t",
        "Quan s√°t th√™m 1-2 l∆∞·ª£t tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh l·ªõn"
      ];
      tips.push(defaultTips[Math.floor(Math.random() * defaultTips.length)]);
    }
    
    return tips.join(' | ');
  }

  // V·∫Ω bi·ªÉu ƒë·ªì ph√¢n t√≠ch
  function renderCharts(results) {
    const labels = results.map((_, i) => `#${i + 1}`);
    const taiCounts = [];
    const xiuCounts = [];
    let taiSum = 0;
    let xiuSum = 0;

    // D·ªØ li·ªáu cho bi·ªÉu ƒë·ªì t·∫ßn su·∫•t
    for (let r of results) {
      if (r === 'T√†i') taiSum++;
      else if (r === 'X·ªâu') xiuSum++;
      taiCounts.push(taiSum);
      xiuCounts.push(xiuSum);
    }

    // D·ªØ li·ªáu cho bi·ªÉu ƒë·ªì ƒë·ªô tin c·∫≠y v√† x√°c su·∫•t
    const confData = [];
    const taiProbData = [];
    const xiuProbData = [];
    
    for (let i = 2; i < results.length; i++) {
      const subset = results.slice(0, i+1);
      const analysis = combinedPrediction(subset);
      
      if (analysis.prediction === 'T√†i') {
        confData.push(analysis.confidence);
      } else {
        confData.push(-analysis.confidence);
      }
      
      taiProbData.push(analysis.taiRatio);
      xiuProbData.push(100 - analysis.taiRatio);
    }

    // H·ªßy c√°c bi·ªÉu ƒë·ªì c≈© n·∫øu c√≥
    if (freqChart) freqChart.destroy();
    if (confChart) confChart.destroy();
    if (probChart) probChart.destroy();

    // Bi·ªÉu ƒë·ªì t·∫ßn su·∫•t
    freqChart = new Chart(freqCanvas.getContext('2d'), {
      type: 'line',
      data: {
        labels,
        datasets: [
          {
            label: 'T√†i (l≈©y k·∫ø)',
            data: taiCounts,
            borderColor: '#00fff7',
            backgroundColor: 'rgba(0,255,255,0.15)',
            fill: true,
            tension: 0.3,
            pointRadius: 3,
            pointHoverRadius: 6,
          },
          {
            label: 'X·ªâu (l≈©y k·∫ø)',
            data: xiuCounts,
            borderColor: '#ff77aa',
            backgroundColor: 'rgba(255,119,170,0.15)',
            fill: true,
            tension: 0.3,
            pointRadius: 3,
            pointHoverRadius: 6,
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            labels: {
              color: '#00ffff',
              font: {
                family: 'Orbitron'
              }
            }
          },
          tooltip: {
            mode: 'index',
            intersect: false,
            backgroundColor: 'rgba(0,40,70,0.9)',
            titleColor: '#00ffff',
            bodyColor: '#ffffff',
            borderColor: '#00ffff',
            borderWidth: 1,
            cornerRadius: 10
          }
        },
        scales: {
          x: {
            ticks: { 
              color: '#00ffff',
              font: {
                family: 'Orbitron'
              }
            },
            grid: { 
              color: 'rgba(0,255,255,0.1)',
              borderColor: 'rgba(0,255,255,0.3)'
            }
          },
          y: {
            beginAtZero: true,
            ticks: { 
              color: '#00ffff',
              font: {
                family: 'Orbitron'
              }
            },
            grid: { 
              color: 'rgba(0,255,255,0.1)',
              borderColor: 'rgba(0,255,255,0.3)'
            }
          }
        },
        animation: {
          duration: 1500,
          easing: 'easeOutQuart'
        }
      }
    });

    // Bi·ªÉu ƒë·ªì ƒë·ªô tin c·∫≠y
    confChart = new Chart(confCanvas.getContext('2d'), {
      type: 'bar',
      data: {
        labels: labels.slice(2),
        datasets: [{
          label: 'ƒê·ªô tin c·∫≠y d·ª± ƒëo√°n',
          data: confData,
          backgroundColor: function(context) {
            const value = context.raw;
            return value > 0 ? 'rgba(0, 255, 255, 0.7)' : 'rgba(255, 119, 170, 0.7)';
          },
          borderColor: function(context) {
            const value = context.raw;
            return value > 0 ? 'rgba(0, 255, 255, 1)' : 'rgba(255, 119, 170, 1)';
          },
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            labels: {
              color: '#00ffff',
              font: {
                family: 'Orbitron'
              }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const value = context.raw;
                return value > 0 
                  ? `T√†i: ${Math.abs(value)}% tin c·∫≠y` 
                  : `X·ªâu: ${Math.abs(value)}% tin c·∫≠y`;
              }
            },
            backgroundColor: 'rgba(0,40,70,0.9)',
            titleColor: '#00ffff',
            bodyColor: '#ffffff',
            borderColor: '#00ffff',
            borderWidth: 1,
            cornerRadius: 10
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            min: -100,
            max: 100,
            ticks: {
              color: '#00ffff',
              callback: function(value) {
                return Math.abs(value) + '%';
              },
              font: {
                family: 'Orbitron'
              }
            },
            grid: { 
              color: 'rgba(0,255,255,0.1)',
              borderColor: 'rgba(0,255,255,0.3)'
            }
          },
          x: {
            ticks: { 
              color: '#00ffff',
              font: {
                family: 'Orbitron'
              }
            },
            grid: { 
              color: 'rgba(0,255,255,0.1)',
              borderColor: 'rgba(0,255,255,0.3)'
            }
          }
        },
        animation: {
          duration: 1500,
          easing: 'easeOutQuart'
        }
      }
    });

    // Bi·ªÉu ƒë·ªì x√°c su·∫•t (n·∫øu c√≥ ƒë·ªß d·ªØ li·ªáu)
    if (results.length >= 3) {
      probChart = new Chart(probCanvas.getContext('2d'), {
        type: 'doughnut',
        data: {
          labels: ['T√†i', 'X·ªâu'],
          datasets: [{
            data: [taiProbData[taiProbData.length - 1], xiuProbData[xiuProbData.length - 1]],
            backgroundColor: ['#00ffff', '#ff77aa'],
            borderColor: ['#00aaff', '#ff5599'],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: '#00ffff',
                font: {
                  family: 'Orbitron',
                  size: 14
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0,40,70,0.9)',
              titleColor: '#00ffff',
              bodyColor: '#ffffff',
              borderColor: '#00ffff',
              borderWidth: 1,
              cornerRadius: 10,
              callbacks: {
                label: function(context) {
                  return `${context.label}: ${context.raw}%`;
                }
              }
            },
            title: {
              display: true,
              text: 'X√°c su·∫•t d·ª± ƒëo√°n hi·ªán t·∫°i',
              color: '#00ffff',
              font: {
                family: 'Orbitron',
                size: 16
              }
            }
          },
          cutout: '65%',
          animation: {
            animateScale: true,
            animateRotate: true
          }
        }
      });
    }
  }

  // Hi·ªáu ·ª©ng loading
  async function showLoading(show) {
    const effect = document.getElementById('analyzingEffect');
    effect.style.display = show ? 'flex' : 'none';
    
    if (show) {
      const processes = [
        "ƒêang ph√¢n t√≠ch chu·ªói k·∫øt qu·∫£...",
        "√Åp d·ª•ng thu·∫≠t to√°n Markov Chain...",
        "T√≠nh to√°n v·ªõi m√¥ h√¨nh LSTM...",
        "T·ªïng h·ª£p k·∫øt qu·∫£ t·ª´ c√°c thu·∫≠t to√°n...",
        "ƒêang ho√†n t·∫•t ph√¢n t√≠ch..."
      ];
      
      let i = 0;
      const interval = setInterval(() => {
        aiProcessText.textContent = processes[i];
        i = (i + 1) % processes.length;
      }, 1500);
      
      return {
        stop: () => {
          clearInterval(interval);
          effect.style.display = 'none';
        },
        interval
      };
    }
  }

  // X·ª≠ l√Ω s·ª± ki·ªán nh·∫≠p k·∫øt qu·∫£
  btnTai.addEventListener('click', function() {
    enteredResults.push('T√†i');
    updateDisplay();
    predictionTab.innerHTML = 'ƒê√£ th√™m k·∫øt qu·∫£ <span style="color:#00ffff">T√†i</span>. B·∫°n c√≥ th·ªÉ ti·∫øp t·ª•c nh·∫≠p ho·∫∑c ph√¢n t√≠ch.';
    btnChart.style.display = 'none';
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
    
    saveData();
  });

  btnXiu.addEventListener('click', function() {
    enteredResults.push('X·ªâu');
    updateDisplay();
    predictionTab.innerHTML = 'ƒê√£ th√™m k·∫øt qu·∫£ <span style="color:#ff77aa">X·ªâu</span>. B·∫°n c√≥ th·ªÉ ti·∫øp t·ª•c nh·∫≠p ho·∫∑c ph√¢n t√≠ch.';
    btnChart.style.display = 'none';
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
    
    saveData();
  });

  // X·ª≠ l√Ω s·ª± ki·ªán ph√¢n t√≠ch
  btnAnalyze.addEventListener('click', async function() {
    if (enteredResults.length < 2) {
      predictionTab.innerHTML = '<div style="color:#ff5555;">‚ùó Vui l√≤ng nh·∫≠p √≠t nh·∫•t 2 k·∫øt qu·∫£ ƒë·ªÉ ph√¢n t√≠ch.</div>';
      
      if (enableSound.checked) {
        errorSound.currentTime = 0;
        errorSound.play();
      }
      
      return;
    }

    const loading = await showLoading(true);
    predictionTab.innerHTML = 'ü§ñ AI PRO ƒëang ph√¢n t√≠ch d·ªØ li·ªáu...';
    
    // Gi·∫£ l·∫≠p th·ªùi gian ph√¢n t√≠ch
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    const analysis = combinedPrediction(enteredResults);
    loading.stop();
    predictionTab.innerHTML = analysis.message;
    
    // Hi·ªÉn th·ªã n√∫t bi·ªÉu ƒë·ªì sau khi ph√¢n t√≠ch
    btnChart.style.display = 'flex';
    renderCharts(enteredResults);
    
    // L∆∞u v√†o l·ªãch s·ª≠ n·∫øu ƒë∆∞·ª£c b·∫≠t
    if (saveHistory.checked) {
      analysisHistory.push({
        date: new Date().toLocaleString(),
        results: [...enteredResults],
        prediction: analysis.prediction,
        message: analysis.message
      });
      renderHistory();
    }
    
    if (enableSound.checked) {
      successSound.currentTime = 0;
      successSound.play();
    }
    
    saveData();
  });

  // X·ª≠ l√Ω s·ª± ki·ªán x√≥a k·∫øt qu·∫£
  btnClear.addEventListener('click', function() {
    enteredResults = [];
    updateDisplay();
    predictionTab.innerHTML = 'ƒê√£ x√≥a h·∫øt k·∫øt qu·∫£ ƒë√£ nh·∫≠p. Vui l√≤ng b·∫Øt ƒë·∫ßu nh·∫≠p l·∫°i.';
    btnChart.style.display = 'none';
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
    
    saveData();
  });

  // M·ªü modal bi·ªÉu ƒë·ªì
  btnChart.addEventListener('click', function() {
    chartModal.style.display = 'flex';
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  // ƒê√≥ng modal bi·ªÉu ƒë·ªì
  chartClose.addEventListener('click', function() {
    chartModal.style.display = 'none';
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  // Chuy·ªÉn ƒë·ªïi gi·ªØa c√°c bi·ªÉu ƒë·ªì
  btnFreqChart.addEventListener('click', function() {
    freqCanvas.style.display = 'block';
    confCanvas.style.display = 'none';
    probCanvas.style.display = 'none';
    btnFreqChart.classList.add('active');
    btnConfChart.classList.remove('active');
    btnProbChart.classList.remove('active');
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  btnConfChart.addEventListener('click', function() {
    if (enteredResults.length < 3) {
      alert('C·∫ßn √≠t nh·∫•t 3 k·∫øt qu·∫£ ƒë·ªÉ hi·ªÉn th·ªã bi·ªÉu ƒë·ªì ƒë·ªô tin c·∫≠y');
      return;
    }
    freqCanvas.style.display = 'none';
    confCanvas.style.display = 'block';
    probCanvas.style.display = 'none';
    btnFreqChart.classList.remove('active');
    btnConfChart.classList.add('active');
    btnProbChart.classList.remove('active');
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  btnProbChart.addEventListener('click', function() {
    if (enteredResults.length < 3) {
      alert('C·∫ßn √≠t nh·∫•t 3 k·∫øt qu·∫£ ƒë·ªÉ hi·ªÉn th·ªã bi·ªÉu ƒë·ªì x√°c su·∫•t');
      return;
    }
    freqCanvas.style.display = 'none';
    confCanvas.style.display = 'none';
    probCanvas.style.display = 'block';
    btnFreqChart.classList.remove('active');
    btnConfChart.classList.remove('active');
    btnProbChart.classList.add('active');
    
    if (enableSound.checked) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  // X·ª≠ l√Ω chuy·ªÉn tab
  tabBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      const tabId = this.getAttribute('data-tab');
      
      // ·∫®n t·∫•t c·∫£ c√°c tab content
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // X√≥a active c·ªßa t·∫•t c·∫£ c√°c tab button
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Hi·ªÉn th·ªã tab ƒë∆∞·ª£c ch·ªçn
      document.getElementById(`${tabId}-tab`).classList.add('active');
      this.classList.add('active');
      
      if (enableSound.checked) {
        clickSound.currentTime = 0;
        clickSound.play();
      }
    });
  });

  // X·ª≠ l√Ω thay ƒë·ªïi c√†i ƒë·∫∑t
  [enableSound, enableAnimations, saveHistory].forEach(setting => {
    setting.addEventListener('change', saveData);
  });

  // T·∫£i d·ªØ li·ªáu khi kh·ªüi ƒë·ªông
  loadData();
  updateDisplay();
  
  // Th√™m hi·ªáu ·ª©ng cho container khi load trang
  if (enableAnimations.checked) {
    document.querySelector('.container').style.animation = 'fadeIn 0.8s ease';
  }
});
  </script>
</body>
</html>
